{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}{{ block.super }}
<script src="{% url 'admin:jsi18n' %}"></script>
{{ media }}
{% endblock %}

{% block extrastyle %}{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'admin/css/forms.css' %}">{% endblock %}

{% block coltype %}colM{% endblock %}

{% block content %}

<form action="{% url 'admin:generate_balances' %}" method="post" name="balances_generate" id="BalancesGenerateForm">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">{% trans 'Generate' %}</button>
</form>
{% block javascript %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  $(document).ready(function () {
      $('#BalancesGenerateForm').submit(function () {
          $.ajax({
              data: $(this).serialize(),
              type: $(this).attr('method'),
              url: "{% url 'admin:generate_balances' %}",
              dataType: "json",
              success: function (response) {
                var obj = jQuery.parseJSON(response);
                alert(obj.message);
              },
              error: function (response) {
                var obj = jQuery.parseJSON(response);
                alert(obj.message);;
              },
          });
          return false;
      });
    })
</script>
{% endblock javascript %}
{% endblock %}